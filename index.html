<!doctype html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cosmic Hama Creations</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="desk-overlay"></div>
    <main class="app-shell">
      <header class="hero-card">
        <h1>Cosmic Hama Creations</h1>
        <p>
          Crea blueprint realistici con stile cottagecore: converti immagini in schemi Hama Beads,
          disegna su griglia e condividi il risultato con un link.
        </p>
      </header>

      <section class="panel controls-panel">
        <h2>Impostazioni progetto</h2>
        <p class="muted">
          Definisci il formato del tuo progetto Hama: dimensioni della base, scala perline e visualizzazione della griglia.
        </p>
        <div class="form-grid">
          <label>
            Larghezza griglia
            <input id="gridWidth" type="number" min="8" max="128" value="32" />
          </label>
          <label>
            Altezza griglia
            <input id="gridHeight" type="number" min="8" max="128" value="32" />
          </label>
          <label>
            Misura perlina (mm)
            <select id="beadSize">
              <option value="2.6">Mini (2.6 mm)</option>
              <option value="5" selected>Midi (5 mm)</option>
              <option value="10">Maxi (10 mm)</option>
            </select>
          </label>
          <label>
            Mostra griglia
            <input id="toggleGrid" type="checkbox" checked />
          </label>
        </div>
        <div class="actions-row">
          <button id="applyGridBtn" class="btn-primary">Applica griglia</button>
          <button id="clearBtn">Svuota progetto</button>
          <button id="downloadBtn">Scarica PNG</button>
        </div>
      </section>

      <section class="panel converter-panel">
        <h2>Converti immagine in schema</h2>
        <p class="muted">
          Trasforma una foto in una bozza bead-by-bead ridotta alla palette Hama, utile come base di partenza da rifinire.
        </p>
        <div class="form-grid">
          <label>
            Carica immagine
            <input id="imageInput" type="file" accept="image/*" />
          </label>
          <label>
            Intensita riduzione colori
            <input id="colorSteps" type="range" min="4" max="24" value="12" />
            <span id="colorStepsValue">12</span>
          </label>
        </div>
        <button id="convertBtn" class="btn-primary">Converti in Hama blueprint</button>
      </section>

      <section class="panel editor-panel">
        <div class="editor-header">
          <h2>Editor blueprint Hama</h2>
          <p class="muted">
            Area di composizione del blueprint: qui costruisci il disegno finale perlina per perlina direttamente sulla plancia.
          </p>
        </div>

        <div class="workspace">
          <aside class="tools-sidebar">
            <div class="palette" id="palette"></div>
            <div class="tool-grid" id="toolBar">
              <button data-tool="pencil" class="paint-tool-btn active icon-btn" title="Matita" aria-label="Matita">
                <svg class="tool-icon hand-drawn" viewBox="0 0 24 24" aria-hidden="true"><path d="M3.8 19.6l4.7-1.1 8.8-8.7-3.2-3.4-9 8.9-1.3 4.3z"/><path d="M13.7 6.5l3.1 3.2"/><path d="M3.4 20.2h5.3"/></svg>
              </button>
              <button data-tool="eraser" class="paint-tool-btn icon-btn" title="Gomma" aria-label="Gomma">
                <svg class="tool-icon hand-drawn" viewBox="0 0 24 24" aria-hidden="true"><path d="M3.2 14.3l6.7-6.9c.8-.8 2-.9 2.9-.1l7.8 7.9-4.4 4.7H8.9l-5.7-5.6z"/><path d="M8.8 20h11.6"/></svg>
              </button>
              <button data-tool="bucket" class="paint-tool-btn icon-btn" title="Secchiello" aria-label="Secchiello">
                <svg class="tool-icon hand-drawn" viewBox="0 0 24 24" aria-hidden="true"><path d="M7.8 6.2l8.1 8.1-5.2 5.3c-1.1 1.1-2.9 1.1-4.1 0L2.6 15.7c-1.1-1.1-1.1-2.9 0-4.1l5.2-5.4z"/><path d="M14.9 4.3l4.7 4.8"/><path d="M17.7 18.7c0 1.3 1 2.3 2.3 2.3s2.3-1 2.3-2.3c0-1.1-1.5-3-2.3-3.9-.9.9-2.3 2.8-2.3 3.9z"/></svg>
              </button>
              <button data-tool="line" class="paint-tool-btn icon-btn" title="Linea" aria-label="Linea">
                <svg class="tool-icon hand-drawn" viewBox="0 0 24 24" aria-hidden="true"><path d="M4.1 18.8L19.1 4.6"/><circle cx="4.1" cy="18.8" r="1.8"/><circle cx="19.1" cy="4.6" r="1.8"/></svg>
              </button>
              <button data-tool="rect" class="paint-tool-btn icon-btn" title="Rettangolo" aria-label="Rettangolo">
                <svg class="tool-icon hand-drawn" viewBox="0 0 24 24" aria-hidden="true"><path d="M4.6 6.7h14.8v10.6H4.6z"/></svg>
              </button>
              <button data-tool="circle" class="paint-tool-btn icon-btn" title="Cerchio" aria-label="Cerchio">
                <svg class="tool-icon hand-drawn" viewBox="0 0 24 24" aria-hidden="true"><path d="M19.1 12.2c0 4-3.1 6.9-7.1 6.9-4.1 0-7.2-3-7.2-7s3.1-7 7.2-7c4 0 7.1 3 7.1 7.1z"/></svg>
              </button>
            </div>
            <div class="history-row">
              <button id="undoBtn" class="icon-btn" title="Annulla" aria-label="Annulla">
                <svg class="tool-icon hand-drawn" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.8 7.1L4 12l4.8 4.9"/><path d="M19.7 12H4"/><path d="M19.7 12c0-3.4-2.6-6-6-6"/></svg>
              </button>
              <button id="redoBtn" class="icon-btn" title="Ripristina" aria-label="Ripristina">
                <svg class="tool-icon hand-drawn" viewBox="0 0 24 24" aria-hidden="true"><path d="M15.2 7.1L20 12l-4.8 4.9"/><path d="M4.3 12H20"/><path d="M4.3 12c0-3.4 2.6-6 6-6"/></svg>
              </button>
            </div>
          </aside>
          <div class="canvas-wrap">
            <canvas id="beadCanvas" width="640" height="640" aria-label="Canvas bead editor"></canvas>
          </div>
        </div>
      </section>

      <section class="panel share-panel">
        <h2>Condivisione blueprint</h2>
        <p class="muted">Crea un link portabile del progetto per continuare o mostrare il blueprint su altri dispositivi.</p>
        <div class="actions-row">
          <button id="shareBtn" class="btn-primary">Genera link</button>
          <input id="shareLink" type="text" readonly placeholder="Il link apparira qui..." />
        </div>
      </section>
    </main>

    <script src="app.js" defer></script>
  </body>
</html>
